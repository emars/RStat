<!doctype html>
<html>
  <head>
    <title>ME - RStat</title>
    <link rel="stylesheet" href="/styles/bootstrap.css" />
    <link rel="stylesheet" href="/styles/flat-ui.css" />
  </head>
  <body>
    <div class="container">
      <h3 class="text-center">My RStats</h3>
      <p id="loading" class="text-center">loading...</p>
      <div id="datum" style="display:none;">
      <p>Total Links Clicked: <span id="links"></span></p>
      <canvas width="400" height="400" id="chart">ur computer isn't gud enuf for rstat</canvas>
    </div>
    </div>
    <script src="/scripts/jquery.min.js"></script>
    <script src="/scripts/Chart.min.js"></script>
    <script src="/scripts/moment.js"></script>
    <script>
    var test;
      $(document).ready(function(){
        var ctx = document.getElementById('chart').getContext('2d');
        var myChart = new Chart(ctx);
        $.get('/data', function(data){
          test = data;
          var times = data.timestamps;
          $('#loading').hide();
          $('#datum').show();
          $('#links').text(data.links);
          console.log(getWeeklyLabels(times));
        });
      });

      function getWeeklyLabels(timestamps){
        var labels = [];
        var firstDay = moment(timestamps[0]);
        for(var i = 0; i < 7; i++){
          labels.push(firstDay.subtract(1, 'days').format('dddd'));
        }
        return labels;
      }
    </script>
  </body>
</html>
